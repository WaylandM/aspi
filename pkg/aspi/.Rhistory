}
}
e <- e+1
}
}else if(hostSeason$right>damageThreshold){
while(e<exposuresPerSeason){
for (p in 1:parasitesPerExposure){
if(runif(1,0,1)<0.75){
hostSeason$right <- hostSeason$right + 1
}else{
hostSeason$left <- hostSeason$left + 1
}
}
e <- e+1
}
}else{
for (p in 1:parasitesPerExposure){
if(runif(1,0,1)<0.5){
hostSeason$left <- hostSeason$left + 1
}else{
hostSeason$right <- hostSeason$right + 1
}
}
}
e <- e+1
}
hostLifetime$left <- hostLifetime$left + hostSeason$left
hostLifetime$right <- hostLifetime$right + hostSeason$right
}
return(hostLifetime)
}
infectionNeutral <- function(parasitesPerExposure,exposuresPerSeason,numSeasons){
totalParasites <- parasitesPerExposure * exposuresPerSeason * numSeasons
hostLifetime <- list(0,0)
names(hostLifetime) <- c("left", "right")
for (i in 1:totalParasites){
if(runif(1,0,1)<0.5){
hostLifetime$left <- hostLifetime$left + 1
}else{
hostLifetime$right <- hostLifetime$right + 1
}
}
return(hostLifetime)
}
set.seed(1995)
results <- lapply(1:10000, infection, parasitesPerExposure=10, exposuresPerSeason=10, numSeasons=3)
results <- lapply(1:100, infectionPositiveFeedback, parasitesPerExposure=10, exposuresPerSeason=10, numSeasons=3, damageThreshold=8)
?lapply
hostsPF <- lapply(1:100, function(i){infectionPositiveFeedback(10,10,3,10,8)})
hostsPF <- lapply(1:100, function(i){infectionPositiveFeedback(10,10,3,8)})
hostsPF <- lapply(1:1000, function(i){infectionPositiveFeedback(10,10,3,8)})
Sys.time()
system.time
?system.time
system.time(hostsPF <- lapply(1:10000, function(i){infectionPositiveFeedback(10,10,3,8)}))
length(hostsPF)
hostsPF[1]
hostsPF[2]
hostsPF[3]
hostsPF2 <- unlist(hostsPF)
hostsPF2[1:5]
hostsPF2 <- as.data.frame(matrix(unlist(hostsPF), ncol=2, byrow=T))
View(hostsPF2)
system.time(gTestHostsPF <- g.test(hostsPF))
hostsPF
system.time(hostsPF <- lapply(1:10000, function(i){infectionPositiveFeedback(10,10,3,8)}))
hostsPF <- as.data.frame(matrix(unlist(hostsPF), ncol=2, byrow=T))
names(hostsPF) <- c("left", "right")
system.time(gTestHostsPF <- g.test(hostsPF))
gTestHostsPF
sum(gTestHostsPF$hosts$BF<0.05)
(gTestHostsPF$hosts$BF<0.05)
(gTestHostsPF$hosts$BF)
gTestHostsPF
names(gTestHostsPF)
(gTestHostsPF$summary)
(gTestHostsPF$hosts)
(gTestHostsPF$hosts$BH)
sum(gTestHostsPF$hosts$BH<0.05)
?chisq.test
m <- matrix(c(1:4), ncol=2)
m
chisq.test(m)
m <- matrix(c(41:44), ncol=2)
chisq.test(m)
m <- matrix(c(10,0,20,23), ncol=2)
chisq.test(m)
m <- matrix(c(10,5,20,23), ncol=2)
chisq.test(m)
m <- matrix(c(10,4,20,23), ncol=2)
chisq.test(m)
m <- matrix(c(5,4,6,7), ncol=2)
chisq.test(m)
?fisher.test
?binom.test
binom.test(5,5)
binom.test(5,5, alternative="two.sided")
binom.test(5,10, alternative="two.sided")
binom.test(5,5, alternative="two.sided")
binom.test(5,10, alternative="two.sided")
binom.test(5,10, alternative="two.sided")$p.value
binom.test(0,10, alternative="two.sided")$p.value
binom.test(10,10, alternative="two.sided")$p.value
1 - (1-0.05)^20
0.05*20
shiny::runGitHub(repo="aspi", username="waylandm", subdir="gui")
library(shiny)
install.packages(c("shiny","DT"), dependencies=TRUE)
install.packages(c("shiny","DT"), dependencies=TRUE)
install.packages(c("shiny","DT"), dependencies=TRUE)
install.packages("RCurl", dependencies = TRUE)
library(RCurl)
eval(expr = parse(text = getURL("https://raw.githubusercontent.com/WaylandM/aspi/master/cli/aspi.R", ssl.verifypeer=FALSE) ))
getwd()
list.files()
setwd("git_repositories/aspi/data/parasites/")
list.files()
sim
sim <- read.csv("simulated_symmetrical_infection.csv")
View(sim)
g.test(sim)
g.test(sim[,2:3])
sim
sample(90:110,2)
sample(90:110,2)
sample(90:110,2)
sample(90:110,2)
sample(90:110,2)
sample(90:110,2)
sample(90:110,2)
sample(90:110,2)
sample(90:110,2)
sim[9,2] <- 98
sim[9,3] <- 108
sim
g.test(sim)
g.test(sim[,2:3])
write.csv(sim, "simulated_symmetrical_infection.csv", quote=F)
homo
leftHomo <- read.csv("simulated_left_bias_homogeneous_proportions.csv")
g.test(leftHomo)
g.test(leftHomo[,2:3])
leftHetero <- read.csv("simulated_left_bias_heterogeneous_proportions.csv")
g.test(leftHetero[,2:3])
as
asym
asym <- read.csv("simulated_asymmetry_inconsistent_bias.csv")
g.test(asym)
g.test(asym[,2:3])
asym[3,2] <- 74
asym[3,3] <- 195
asym[8,2] <- 75
asym[8,3] <- 106
g.test(asym[,2:3])
write.csv(asym, "simulated_asymmetry_inconsistent_bias.csv", quote=F)
shiny::runGitHub(repo="aspi", username="waylandm", subdir="gui")
x <- c(1,2)
x
getwd()
setwd("Dropbox/bilateral_asymmetry/bilateral_asymmetry_analysis/pkg/aspi/data/")
setwd("..")
getwd()
load("data/diplostomum_eyes_excl_lenses.rda")
ls()
names(diplostomum_eyes_excl_lenses)
rm(list=ls())
devtools::load_all()
?diplostomum_eye_excl_lenses
devtools::load_all()
?aspi
??aspi
?diplostomum
?diplostomum_eyes_excl_lenses
diplostomum_eyes_excl_lenses
devtools::document()
devtools::load_all()
?diplostomum_eyes_excl_lenses
devtools::document()
devtools::load_all()
?diplostomum_eyes_excl_lenses
library(ggplot2)
?diamonds
?diplostomum_eyes_excl_lenses
?diamonds
?diplostomum_eyes_excl_lenses
devtools::document()
devtools::load_all()
?diplostomum_eyes_excl_lenses
devtools::document()
devtools::load_all()
?diplostomum_eyes_excl_lenses
?diplostomum_lenses
.libPaths()
devtools::document()
devtools::load_all()
?diplostomum_eyes_excl_lenses
devtools::document()
devtools::load_all()
?diplostomum_eyes_excl_lenses
g.test
?g.test
devtools::document()
devtools::load_all()
?simulated_symmetrical_infection
?aspi
??aspi
aspi::eb.test()
?t.test
?ks.test
aspi::.prepareData()
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
?g.test
devtools::document()
devtools::load_all()
?g.test
?devtools
?description
?desc
g.test(diplostomum_lenses)
?hist
?t.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
.prepareData
devtools::document()
devtools::load_all()
.prepareData
packageDescription(aspi)
packageVersion(aspi)
devtools::document()
devtools::document()
devtools::load_all()
?aspi
??aspi
library(EBImage)
?EBImage
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?aspi
?foo
devtools::document()
devtools::load_all()
?aspi
devtools::document()
devtools::load_all()
?aspi
devtools::document()
devtools::load_all()
?aspi
?EBImage
?aspi
devtools::document()
devtools::load_all()
?aspi
devtools::document()
devtools::load_all()
?aspi
devtools::document()
devtools::load_all()
?aspi
devtools::document()
devtools::load_all()
?aspi
g.test(diplostomum_eyes_excl_lenses)
g.test(diplostomum_lenses)
devtools::document()
devtools::load_all()
?aspi
?simulated_symmetrical_infection
?t.test
?ks.test
devtools::document()
devtools::load_all()
?aspi
?g.test
devtools::document()
devtools::load_all()
?eb.test
devtools::document()
devtools::load_all()
?eb.test
?t-test
?t.test
?"hist"
devtools::document()
devtools::load_all()
?plotHistogram
?g.test
?plotHistogram
?"hist"
devtools::document()
devtools::load_all()
?plotHistogram
devtools::document()
devtools::load_all()
?plotHistogram
devtools::document()
devtools::load_all()
?plotHistogram
devtools::document()
devtools::load_all()
?plotHistogram
?g.test
?eb.test
?t.test
devtools::document()
devtools::load_all()
?g.test
devtools::document()
devtools::load_all()
?g.test
?eb.test
devtools::document()
devtools::load_all()
?eb.test
devtools::document()
devtools::load_all()
?plotHistogram
devtools::document()
devtools::load_all()
?plotVolcano
devtools::document()
devtools::document()
devtools::load_all()
?plotVolcano
?aspi
devtools::document()
devtools::load_all()
?plotVolcano
plotVolcano(diplostomum_eyes_excl_lenses)
plotVolcano(diplostomum_eyes_excl_lenses, test="G", pAdj="EB", sigThresh=0.1, main="Diplostomum metacercariae in eyes of ruffe")
?plotHistogram
plotHistogram(diplostomum_eyes_excl_lenses)
plotHistogram(diplostomum_eyes_excl_lenses,nBreaks=20,main="Diplostomum metacercariae in eyes of ruffe")
browseVignettes(aspi)
browseVignettes('aspi')
browseVignettes(devtools)
browseVignettes('devtools')
devtools::use_testthat()
?aspi
g.test(diplostomum_lenses)
devtools::test()
devtools::test()
getwd()
devtools::load_all()
devtools::test()
devtools::test
devtools::test()
devtools::test()
devtools::test()
test()
devtools::test()
devtools::test()
devtools::load_all()
devtools::test()
devtools::load_all()
devtools::test()
devtools::load_all()
devtools::test()
devtools::test()
?aspi
eb.test(diplostomum_lenses)
length(eb.test(diplostomum_lenses))
result <- eb.test(diplostomum_lenses)
length(result)
is.numeric(result[1])
result
is.numeric(result$pooled)
names(result)
length(result$hosts[,1])
devtools::test()
devtools::test()
devtools::test()
length(result$hosts[,1])
devtools::test()
devtools::test()
?expect_equal
devtools::test()
result <- eb.test(diplostomum_lenses)
host28 <- result$hosts[3,]
host28
host28$Left
host28$Right
host28$Host
as.numeric(host28$Host)
as.numeric(as.character(host28$Host))
host28$p
host28$BH
host28$Holm
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
ls()
fix(result)
fix(result$hosts)
x <- result$hosts
fix(x)
result <- g.test(diplostomum_eyes_excl_lenses)
result
result$summary
result$hosts
result$summary$Test
result$summary$Test[1]
result$summary$Test[2]
result$summary$Test[3]
devtools::test()
devtools::test()
result$summary
devtools::test()
devtools::test()
devtools::test()
devtools::test()
result$summary$df[1]
result$summary$G[1]
devtools::load_all()
devtools::test()
result <- g.test(diplostomum_eyes_excl_lenses)
result$summary$df[3]
x <- result$summary
x
x[1,3]
calcG <- function(fL, fR, df=1){
fSum <- fL+fR
G <- 2*(fL*log(fL/(fSum*0.5)) + fR*log(fR/(fSum*0.5)))
pval <- pchisq(G, df, lower.tail=F)
return(c(G, pval))
}
# G for each individual host GI
individualG <- apply(x, 1, function(r){
return(calcG(r[1],r[2]))
})
calcG <- function(fL, fR, df=1){
fSum <- fL+fR
G <- 2*(fL*log(fL/(fSum*0.5)) + fR*log(fR/(fSum*0.5)))
pval <- pchisq(G, df, lower.tail=F)
return(c(G, pval))
}
calcG(10,10,1)
y <- calcG(10,10)
y[1]
y[2]
ls()
result$hosts
storage.mode(result$hosts)
rh <- result$hosts
rh[1,]
rh$Host
rh$Left
rh$Right
rh$G
devtools::load_all()
devtools::test()
rm(list=ls())
devtools::load_all()
devtools::test()
devtools::test()
result <- g.test(diplostomum_eyes_excl_lenses)
result$hosts
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::check()
devtools::test()
run_examples()
devtools::run_examples()
devtools::check_docs()
