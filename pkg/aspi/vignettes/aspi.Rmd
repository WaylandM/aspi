---
title: "ASPI - Analysis of Symmetry of Parasitic Infections"
author: "Matt Wayland"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette 
bibliography: aspi.bib
vignette: >
  %\VignetteIndexEntry{ASPI - Analysis of Symmetry of Parasitic Infections}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Introduction
When parasites invade paired structures of their host non-randomly, the resulting asymmetry may have both pathological and ecological significance. ASPI has been developed to facilitate the detection and visualization of asymmetric infections. ASPI can detect both consistent bias towards one side, and inconsistent bias in which the left side is favored in some hosts and the right in others. In this vignette ASPI is demonstrated on both observed and simulated parasite distributions.

##Detection of deviation from symmetry

###Replicated G-tests of goodness-of-fit
Replicated G-tests of goodness-of-fit [@biometry] are ASPI's default method for detecting bilateral asymmetry. This procedure computes four different G-statistics:

* **Total G** - tests null hypothesis that overall the parasite distributions in all individual hosts do not depart from symmetry.
* **Pooled G** - evaluates the null hypothesis that the ratio of the total number of parasites from each side does not differ from symmetry.
* **Heterogeneity G** - examines the null hypothesis that the left:right ratios are the same in all individual hosts. 
* **Individual G** - used to identify which individual hosts have asymmetrical parasite distributions.

###Binomial exact test
G-tests involve logarithmic transformation and so cannot be applied to counts of zero. Moreover, G-tests are not recommended when counts are below 10. For this situation, binomial exact tests are provided as an alternative, but are limited to testing two null hypotheses:

* the ratio of the total number of parasites on each side doesn't differ from 1:1 (equivalent to the pooled G-test);
* the distribution of parasites in an individual host is symmetrical.

##Data format
Data for analysis should be in a matrix of data.frame with two numeric columns. Each row represents one host. The first column is the number of parasites recorded from the left-side of the host and the 2nd column is the number of parasites recorded from the right-side. Identifiers for hosts can be provided as row names.

```r
library(aspi)
simulated_symmetrical_infection
```

###Correction for multiple comparisons
When applying hypothesis tests to individual hosts we have to control for multiple comparisons using one of the following two procedures:

####False discovery rate (FDR)
The FDR is the proportion of false positives among all significant test results. Benjamini and Hochberg's method is used to control the FDR.

####Familywise error rate (FWER)
The FWER is the probability of a single false positive among a collection (family) of hypothesis tests. Holm's procedure is used to control the FWER.




## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}

plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
